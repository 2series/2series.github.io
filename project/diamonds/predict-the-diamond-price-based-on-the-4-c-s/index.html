<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 3.3.0">
  <meta name="generator" content="Hugo 0.53" />
  <meta name="author" content="Rihad Variawa">

  
  
  
  
    
  
  <meta name="description" content="Am I getting a fair deal when I purchase a diamond?">

  
  <link rel="alternate" hreflang="en-us" href="../../../project/diamonds/predict-the-diamond-price-based-on-the-4-c-s/">

  


  

  

  

  

  

  

  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" crossorigin="anonymous">
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Playfair+Display:400,700|Fauna+One">
  

  <link rel="stylesheet" href="../../../styles.css">
  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-132898309-1', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  
  <link rel="alternate" href="../../../index.xml" type="application/rss+xml" title="Rihad Variawa">
  <link rel="feed" href="../../../index.xml" type="application/rss+xml" title="Rihad Variawa">
  

  <link rel="manifest" href="../../../site.webmanifest">
  <link rel="icon" type="image/png" href="../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../img/icon-192.png">

  <link rel="canonical" href="../../../project/diamonds/predict-the-diamond-price-based-on-the-4-c-s/">

  
  
  
  
    
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Rihad Variawa">
  <meta property="og:url" content="/project/diamonds/predict-the-diamond-price-based-on-the-4-c-s/">
  <meta property="og:title" content="Predict the diamond price based on the 4 c&#39;s | Rihad Variawa">
  <meta property="og:description" content="Am I getting a fair deal when I purchase a diamond?"><meta property="og:image" content="/img/headers/diamond.jpg">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2019-01-25T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2019-01-25T00:00:00&#43;00:00">
  

  

  

  <title>Predict the diamond price based on the 4 c&#39;s | Rihad Variawa</title>

</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >
  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" role="textbox" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="../../../">Rihad Variawa</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="../../../#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="../../../#publications">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="../../../#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="../../../#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="../../../#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="../../../files/resume.pdf">
            
            <span>Resume</span>
            
          </a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


<article class="article article-project" itemscope itemtype="http://schema.org/Article">

  









<div class="article-header">
  
  
  <img src="../../../img/headers/diamond.jpg" class="article-banner" itemprop="image" alt="">
  

  
</div>




  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Predict the diamond price based on the 4 c&#39;s</h1>

  

  
    

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Rihad Variawa">
  </span>
  

  <span class="article-date">
    
    <meta content="2019-01-25 00:00:00 &#43;0000 UTC" itemprop="datePublished">
    <time datetime="2019-01-25 00:00:00 &#43;0000 UTC" itemprop="dateModified">
      Jan 25, 2019
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Rihad Variawa">
  </span>

  

  
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    
    <a href="../../../categories/r/">R</a>, 
    
    <a href="../../../categories/machine-learning/">Machine Learning</a>
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Predict%20the%20diamond%20price%20based%20on%20the%204%20c%27s&amp;url=%2fproject%2fdiamonds%2fpredict-the-diamond-price-based-on-the-4-c-s%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fproject%2fdiamonds%2fpredict-the-diamond-price-based-on-the-4-c-s%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fproject%2fdiamonds%2fpredict-the-diamond-price-based-on-the-4-c-s%2f&amp;title=Predict%20the%20diamond%20price%20based%20on%20the%204%20c%27s"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fproject%2fdiamonds%2fpredict-the-diamond-price-based-on-the-4-c-s%2f&amp;title=Predict%20the%20diamond%20price%20based%20on%20the%204%20c%27s"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Predict%20the%20diamond%20price%20based%20on%20the%204%20c%27s&amp;body=%2fproject%2fdiamonds%2fpredict-the-diamond-price-based-on-the-4-c-s%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    















  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      


<div id="preamble" class="section level2">
<h2>Preamble:</h2>
<p>This document focuses on the analysis of the diamonds data frame.</p>
<p>Descriotion of data frame diamonds can be found at <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/diamonds.html" class="uri">https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/diamonds.html</a></p>
</div>
<div id="research-questions" class="section level2">
<h2>Research questions:</h2>
<ol style="list-style-type: decimal">
<li><p>am i getting a fair deal when I purchase a diamond?</p></li>
<li><p>The goal is to build a predictive model for diamonds, that is going to help figure out whether a given diamond is a <strong>good deal</strong> or a <strong>rip-off!</strong></p></li>
</ol>
</div>
<div id="structure-of-analysis" class="section level2">
<h2>Structure of analysis:</h2>
<p>I will use Linear Regression to predict the diamond price using other varaibles in the diamonds dataframe.</p>
</div>
<div id="get-to-know-the-data" class="section level2">
<h2>Get to know the Data</h2>
<pre class="r"><code>str(diamonds)</code></pre>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    53940 obs. of  10 variables:
##  $ carat  : num  0.23 0.21 0.23 0.29 0.31 0.24 0.24 0.26 0.22 0.23 ...
##  $ cut    : Ord.factor w/ 5 levels &quot;Fair&quot;&lt;&quot;Good&quot;&lt;..: 5 4 2 4 2 3 3 3 1 3 ...
##  $ color  : Ord.factor w/ 7 levels &quot;D&quot;&lt;&quot;E&quot;&lt;&quot;F&quot;&lt;&quot;G&quot;&lt;..: 2 2 2 6 7 7 6 5 2 5 ...
##  $ clarity: Ord.factor w/ 8 levels &quot;I1&quot;&lt;&quot;SI2&quot;&lt;&quot;SI1&quot;&lt;..: 2 3 5 4 2 6 7 3 4 5 ...
##  $ depth  : num  61.5 59.8 56.9 62.4 63.3 62.8 62.3 61.9 65.1 59.4 ...
##  $ table  : num  55 61 65 58 58 57 57 55 61 61 ...
##  $ price  : int  326 326 327 334 335 336 336 337 337 338 ...
##  $ x      : num  3.95 3.89 4.05 4.2 4.34 3.94 3.95 4.07 3.87 4 ...
##  $ y      : num  3.98 3.84 4.07 4.23 4.35 3.96 3.98 4.11 3.78 4.05 ...
##  $ z      : num  2.43 2.31 2.31 2.63 2.75 2.48 2.47 2.53 2.49 2.39 ...</code></pre>
<pre class="r"><code>summary(diamonds)</code></pre>
<pre><code>##      carat               cut        color        clarity     
##  Min.   :0.2000   Fair     : 1610   D: 6775   SI1    :13065  
##  1st Qu.:0.4000   Good     : 4906   E: 9797   VS2    :12258  
##  Median :0.7000   Very Good:12082   F: 9542   SI2    : 9194  
##  Mean   :0.7979   Premium  :13791   G:11292   VS1    : 8171  
##  3rd Qu.:1.0400   Ideal    :21551   H: 8304   VVS2   : 5066  
##  Max.   :5.0100                     I: 5422   VVS1   : 3655  
##                                     J: 2808   (Other): 2531  
##      depth           table           price             x         
##  Min.   :43.00   Min.   :43.00   Min.   :  326   Min.   : 0.000  
##  1st Qu.:61.00   1st Qu.:56.00   1st Qu.:  950   1st Qu.: 4.710  
##  Median :61.80   Median :57.00   Median : 2401   Median : 5.700  
##  Mean   :61.75   Mean   :57.46   Mean   : 3933   Mean   : 5.731  
##  3rd Qu.:62.50   3rd Qu.:59.00   3rd Qu.: 5324   3rd Qu.: 6.540  
##  Max.   :79.00   Max.   :95.00   Max.   :18823   Max.   :10.740  
##                                                                  
##        y                z         
##  Min.   : 0.000   Min.   : 0.000  
##  1st Qu.: 4.720   1st Qu.: 2.910  
##  Median : 5.710   Median : 3.530  
##  Mean   : 5.735   Mean   : 3.539  
##  3rd Qu.: 6.540   3rd Qu.: 4.040  
##  Max.   :58.900   Max.   :31.800  
## </code></pre>
</div>
<div id="scatterplot" class="section level1">
<h1>Scatterplot</h1>
<p>We’ll start by examining two variables in the set. A scatterplot is a powerful tool to help you understand the relationship between two continuous variables.</p>
<p>We can quickly see if the relationship is linear or not. In this case, we can use a variety of diamond characteristics to help us figure out whether the price advertised for any given diamond is reasonable or a rip-off.</p>
<p>Consider the price of a diamond and it’s carat weight.</p>
<pre class="r"><code>## create a scatterplot of price and carat 
ggplot(diamonds, aes(carat, price)) +
  geom_point(fill = I(&quot;#F79420&quot;), color = I(&quot;black&quot;), shape = 23) +
  xlim(0, quantile(diamonds$carat,0.99)) +
  ylim(0, quantile(diamonds$price,0.99)) +
  ggtitle(&#39;Price vs. Carat&#39;) +
  theme_classic()</code></pre>
<p><img src="../../../project/diamonds/2019-01-25-predict-the-diamond-price-based-on-the-4-c-s_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Observations:</p>
<ul>
<li>The larger the diamond is (or the more carats it has), the more expensive the diamond is (price), which is probably what we would have expected.</li>
</ul>
<pre class="r"><code>## create a scatterplot of price and carat with linear trend
ggplot(diamonds, aes(carat, price)) +
  geom_point(fill = I(&quot;#F79420&quot;), color = I(&quot;black&quot;), shape = 23) +
  stat_smooth(method = &quot;lm&quot;) +
  scale_x_continuous(lim = c(0, quantile(diamonds$carat, 0.99)) ) +
  scale_y_continuous(lim = c(0, quantile(diamonds$price, 0.99)) ) +
  ggtitle(&quot;Price vs. Carat&quot;) +
  theme_classic()</code></pre>
<p><img src="../../../project/diamonds/2019-01-25-predict-the-diamond-price-based-on-the-4-c-s_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Observations:</p>
<ul>
<li>The linear trend line doesn’t go through the center of the data at some key places. It should curve in certain parts of the graph, i.e slope up more towards the end. If we tried to use this for predictions, we might be off some key places inside and outside of the existing data that we have displayed.</li>
</ul>
<pre class="r"><code>## sample 10,000 diamonds from the set to get a snapshop of the large dataframe
set.seed(20022012)
diamond_samp &lt;- diamonds[sample(1:length(diamonds$price), 10000), ]
ggpairs(diamond_samp, 
        lower = list(continuous = wrap(&quot;points&quot;, shape = I(&#39;.&#39;))), 
        upper = list(combo = wrap(&quot;box&quot;, outlier.shape = I(&#39;.&#39;))))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="../../../project/diamonds/2019-01-25-predict-the-diamond-price-based-on-the-4-c-s_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Observations:</p>
<ul>
<li>Price is almost linearly correlated with carat: These are the critical factors driving price.</li>
<li>Price appears related to <strong>cut/color/clarity</strong> but, is not very clear from this plot.</li>
<li>Price appears not to be directly related to depth and table.</li>
</ul>
<pre class="r"><code>## create hist of price and price(log10)
plot1 &lt;- ggplot(diamonds, aes(price)) +
  geom_histogram(color = &#39;blue&#39;, fill = &#39;blue&#39;, binwidth = 200) +
  scale_x_continuous(breaks = seq(300, 19000, 1000), limit = c(300, 19000)) +
  ggtitle(&#39;Price&#39;) +
  theme_classic()

plot2 &lt;- ggplot(diamonds, aes(price)) +
  geom_histogram(color = &#39;red&#39;, fill = &#39;red&#39;, binwidth = 0.01) +
  scale_x_log10(breaks = seq(300, 19000, 1000), limit = c(300, 19000)) +
  ggtitle(&#39;Price(log10)&#39;) +
  theme_classic()

grid.arrange(plot1, plot2, ncol = 2)</code></pre>
<p><img src="../../../project/diamonds/2019-01-25-predict-the-diamond-price-based-on-the-4-c-s_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Observations:</p>
<ul>
<li>Price histogram is skewed to the right, while the log10(price) tends to be a bell curve distributed. Also, the two peaks in the log10(price) plot coincides with the 1st and 3rd quantile of price.</li>
</ul>
<pre class="r"><code>## create scatterplot of price and price(log10)
p1 &lt;- ggplot(diamonds, aes(carat, price, color=clarity)) +
  geom_point() +
  ggtitle(&quot;Price by Carat&quot;) +
  theme_classic()

p2 &lt;- ggplot(diamonds, aes(carat, price, color=clarity)) +
  geom_point() +
  scale_y_continuous(trans = log10_trans()) +
  ggtitle(&quot;Price(log10) by Carat&quot;) +
  theme_classic()
grid.arrange(p1, p2, ncol=1)</code></pre>
<p><img src="../../../project/diamonds/2019-01-25-predict-the-diamond-price-based-on-the-4-c-s_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Observations:</p>
<ul>
<li>On the log scale, the prices look less dispersed at the high end of carat size and price, however, we can do better. Let’s try using the cube root of carat in light of our speculation about flaws being exponentially more likely in diamonds with more volume. Remember, volume is on a cubic scale!</li>
</ul>
<pre class="r"><code>### create a new function to transform the carat variable
cuberoot_trans = function() trans_new(&#39;cuberoot&#39;,
                                      transform = function(x) x^(1/3),
                                      inverse = function(x) x^3)

### use the cuberoot_trans function
ggplot(diamonds, aes(carat, price, color=clarity)) + 
  geom_point(alpha = 1/2, size = 1, position = &quot;jitter&quot;) + 
  scale_x_continuous(trans = cuberoot_trans(), limits = c(0.2, 3),
                     breaks = c(0.2, 0.5, 1, 2, 3)) + 
  scale_y_continuous(trans = log10_trans(), limits = c(350, 15000),
                     breaks = c(350, 1000, 5000, 10000, 15000)) +
  ggtitle(&#39;Price(log10) by Cube-Root of Carat&#39;) +
  theme_classic()</code></pre>
<p><img src="../../../project/diamonds/2019-01-25-predict-the-diamond-price-based-on-the-4-c-s_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Observations:</p>
<ul>
<li>The price(log10) is almost linear with cuberoot of carat. We can now move ahead and see how to model our data using just a linear model.</li>
</ul>
<div id="price-vs.carat-and-clarity" class="section level2">
<h2>Price vs. Carat and Clarity</h2>
<pre class="r"><code>## to work around overplotting, the alpha, size, and and jitter options are used in our plot
ggplot(diamonds, aes(x = carat, y = price)) + 
  geom_point(alpha = 1/2, size = 1, position = &#39;jitter&#39;, aes(color=clarity)) +
  scale_color_brewer(type = &#39;div&#39;,
    guide = guide_legend(title = &#39;Clarity&#39;, reverse = T,
    override.aes = list(alpha = 1, size = 2))) +                         
  scale_x_continuous(trans = cuberoot_trans(), limits = c(0.2, 3),
    breaks = c(0.2, 0.5, 1, 2, 3)) + 
  scale_y_continuous(trans = log10_trans(), limits = c(350, 15000),
    breaks = c(350, 1000, 5000, 10000, 15000)) +
  ggtitle(&#39;Price(log10) by Cube-Root of Carat and Clarity&#39;) +
  theme_classic()</code></pre>
<p><img src="../../../project/diamonds/2019-01-25-predict-the-diamond-price-based-on-the-4-c-s_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Observations:</p>
<ul>
<li>Clarity factors into the price of a diamond. Hence, a better clarity results in a higher price than lower end clarity.</li>
</ul>
</div>
<div id="price-vs.carat-and-cut" class="section level2">
<h2>Price vs. Carat and Cut</h2>
<pre class="r"><code>## to work around overplotting, the alpha, size, and and jitter options are used in our plot
ggplot(diamonds, aes(x = carat, y = price)) + 
  geom_point(alpha = 1/2, size = 1, position = &#39;jitter&#39;, aes(color=cut)) +
  scale_color_brewer(type = &#39;div&#39;,
    guide = guide_legend(title = &#39;Cut&#39;, reverse = T,
    override.aes = list(alpha = 1, size = 2))) +                         
  scale_x_continuous(trans = cuberoot_trans(), limits = c(0.2, 3),
    breaks = c(0.2, 0.5, 1, 2, 3)) + 
  scale_y_continuous(trans = log10_trans(), limits = c(350, 15000),
    breaks = c(350, 1000, 5000, 10000, 15000)) +
  ggtitle(&#39;Price(log10) by Cube-Root of Carat and Cut&#39;) +
  theme_classic()</code></pre>
<p><img src="../../../project/diamonds/2019-01-25-predict-the-diamond-price-based-on-the-4-c-s_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Observations:</p>
<ul>
<li>Whilst cut does not show as obvious pattern as clarity, it’s still clear that with the same carat the diamonds with the best cut are priced higher. Hence, I think cut should be also included in the price prediction algorithm.
Note, clarity explains a lot of the variance found in price!</li>
</ul>
</div>
<div id="price-vs.carat-and-color" class="section level2">
<h2>Price vs. Carat and Color</h2>
<pre class="r"><code>## to work around overplotting, the alpha, size, and and jitter options are used in our plot
ggplot(diamonds, aes(x = carat, y = price)) + 
  geom_point(alpha = 1/2, size = 1, position = &#39;jitter&#39;, aes(color=color)) +
  scale_color_brewer(type = &#39;div&#39;,
    guide = guide_legend(title = &#39;Color&#39;, reverse = F,
    override.aes = list(alpha = 1, size = 2))) +                         
  scale_x_continuous(trans = cuberoot_trans(), limits = c(0.2, 3),
    breaks = c(0.2, 0.5, 1, 2, 3)) + 
  scale_y_continuous(trans = log10_trans(), limits = c(350, 15000),
    breaks = c(350, 1000, 5000, 10000, 15000)) +
  ggtitle(&#39;Price(log10) by Cube-Root of Carat and Color&#39;) +
  theme_classic()</code></pre>
<p><img src="../../../project/diamonds/2019-01-25-predict-the-diamond-price-based-on-the-4-c-s_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>ggplot(diamonds) +
  geom_bar(mapping = aes(clarity, fill=cut), position = &quot;fill&quot; ) +
  scale_fill_manual(values = c(&quot;red&quot;, &quot;orange&quot;, &quot;darkgreen&quot;, &quot;dodgerblue&quot;, &quot;purple4&quot;)) +
  labs(title = &quot;Clearer diamonds tend to be of higher quality cut&quot;,
       subtitle = &quot;The majority of IF diamonds are an \&quot;Ideal\&quot; cut&quot;) +
  ylab(&quot;proportion&quot;) +
  theme_classic()</code></pre>
<p><img src="../../../project/diamonds/2019-01-25-predict-the-diamond-price-based-on-the-4-c-s_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Observations:</p>
<ul>
<li>This looks similar with previous clarity plot. Color should be also considered as an factor for price.</li>
</ul>
</div>
<div id="build-the-linear-model" class="section level2">
<h2>Build the Linear Model</h2>
<pre class="r"><code>m1 &lt;- lm(I(log10(price)) ~ I(carat^(1/3)), diamonds)
m2 &lt;- update(m1,~ . +carat)
m3 &lt;- update(m2,~ . +cut)
m4 &lt;- update(m3,~ . +color)
m5 &lt;- update(m4,~ . +clarity)
mtable(m1, m2, m3, m4, m5, sdigits = 4)</code></pre>
<pre><code>## 
## Calls:
## m1: lm(formula = I(log10(price)) ~ I(carat^(1/3)), data = diamonds)
## m2: lm(formula = I(log10(price)) ~ I(carat^(1/3)) + carat, data = diamonds)
## m3: lm(formula = I(log10(price)) ~ I(carat^(1/3)) + carat + cut, 
##     data = diamonds)
## m4: lm(formula = I(log10(price)) ~ I(carat^(1/3)) + carat + cut + 
##     color, data = diamonds)
## m5: lm(formula = I(log10(price)) ~ I(carat^(1/3)) + carat + cut + 
##     color + clarity, data = diamonds)
## 
## ==============================================================================================
##                        m1             m2             m3             m4              m5        
## ----------------------------------------------------------------------------------------------
##   (Intercept)          1.225***       0.451***       0.380***       0.405***        0.180***  
##                       (0.003)        (0.008)        (0.008)        (0.007)         (0.004)    
##   I(carat^(1/3))       2.414***       3.721***       3.780***       3.665***        3.971***  
##                       (0.003)        (0.014)        (0.013)        (0.012)         (0.007)    
##   carat                              -0.494***      -0.505***      -0.431***       -0.474***  
##                                      (0.005)        (0.005)        (0.004)         (0.003)    
##   cut: .L                                            0.097***       0.097***        0.052***  
##                                                     (0.002)        (0.002)         (0.001)    
##   cut: .Q                                           -0.027***      -0.027***       -0.013***  
##                                                     (0.002)        (0.001)         (0.001)    
##   cut: .C                                            0.022***       0.022***        0.006***  
##                                                     (0.001)        (0.001)         (0.001)    
##   cut: ^4                                            0.008***       0.008***       -0.001     
##                                                     (0.001)        (0.001)         (0.001)    
##   color: .L                                                        -0.162***       -0.191***  
##                                                                    (0.001)         (0.001)    
##   color: .Q                                                        -0.056***       -0.040***  
##                                                                    (0.001)         (0.001)    
##   color: .C                                                         0.001          -0.006***  
##                                                                    (0.001)         (0.001)    
##   color: ^4                                                         0.012***        0.005***  
##                                                                    (0.001)         (0.001)    
##   color: ^5                                                        -0.007***       -0.001*    
##                                                                    (0.001)         (0.001)    
##   color: ^6                                                        -0.010***        0.001     
##                                                                    (0.001)         (0.001)    
##   clarity: .L                                                                       0.394***  
##                                                                                    (0.001)    
##   clarity: .Q                                                                      -0.104***  
##                                                                                    (0.001)    
##   clarity: .C                                                                       0.057***  
##                                                                                    (0.001)    
##   clarity: ^4                                                                      -0.027***  
##                                                                                    (0.001)    
##   clarity: ^5                                                                       0.011***  
##                                                                                    (0.001)    
##   clarity: ^6                                                                      -0.001     
##                                                                                    (0.001)    
##   clarity: ^7                                                                       0.014***  
##                                                                                    (0.001)    
## ----------------------------------------------------------------------------------------------
##   R-squared            0.9236         0.9349         0.9391         0.9514          0.9839    
##   adj. R-squared       0.9236         0.9349         0.9391         0.9514          0.9839    
##   sigma                0.1218         0.1124         0.1087         0.0972          0.0559    
##   F               652012.0628    387489.3661    138654.5235     87959.4667     173791.0840    
##   p                    0.0000         0.0000         0.0000         0.0000          0.0000    
##   Log-likelihood   37025.2108     41356.3916     43150.2943     49222.9505      79078.9821    
##   Deviance           800.2475       681.5220       637.6655       509.1030        168.2821    
##   AIC             -74044.4217    -82704.7832    -86284.5886    -98417.9011    -158115.9642    
##   BIC             -74017.7348    -82669.2007    -86213.4236    -98293.3623    -157929.1560    
##   N                53940          53940          53940          53940           53940         
## ==============================================================================================</code></pre>
<p>Observations:</p>
<ul>
<li>We get some very nice R square values. We are accounting for almost all of the variance in price using carat, cut, color and clarity. If we want to know whether the price of a diamond is reasonable, we could use this model.</li>
</ul>
<pre class="r"><code>thisDiamond &lt;- data.frame(carat = 1, cut = &#39;Very Good&#39;,
                          color = &#39;G&#39;, clarity = &#39;VS2&#39;)
modelEstimate &lt;- predict(m5, newdata = thisDiamond,
                         interval = &quot;prediction&quot;, level = .95)
10^modelEstimate</code></pre>
<pre><code>##        fit      lwr      upr
## 1 5232.111 4065.993 6732.668</code></pre>
<pre class="r"><code>exp(modelEstimate)</code></pre>
<pre><code>##        fit      lwr      upr
## 1 41.20984 36.93526 45.97911</code></pre>
</div>
</div>

    </div>

    


<div class="article-tags">
  
  <a class="badge badge-light" href="../../../tags/regression/">regression</a>
  
</div>



    






<div class="media author-card" itemscope itemtype="http://schema.org/Person">
  
  <img class="portrait mr-3" src="../../../img/Rihad%20Variawa.png" itemprop="image" alt="Avatar">
  
  <div class="media-body">
    <h5 class="card-title" itemprop="name"><a href="../../../">Rihad Variawa</a></h5>
    <h6 class="card-subtitle">Data Scientist</h6>
    
    <ul class="network-icon" aria-hidden="true">
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="../../../rihadv021@gmail.com" >
          <i class="fas fa-envelope"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://twitter.com/2series_rv" target="_blank" rel="noopener">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://github.com/2series" target="_blank" rel="noopener">
          <i class="fab fa-github"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://www.linkedin.com/in/rihad-variawa-7422017b" target="_blank" rel="noopener">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
      
    </ul>
  </div>
</div>




    
    

    

      
      
      

      
      
      

      
      
      
    

  </div>
</article>



<div class="container">
  <footer class="site-footer">
  
  <p class="powered-by">
    <a href="../../../privacy/">Privacy Policy</a>
  </p>
  

  <p class="powered-by">
    &copy; 2019 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

</div>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        
      

      
      
    

    
    

    
    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    
    
    
    
    
    
    <script src="../../../js/academic.min.70f0041f5a24c6a675ac218c98d7ef71.js"></script>

    

  </body>
</html>

